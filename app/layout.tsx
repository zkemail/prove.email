'use client';
import React, { PropsWithChildren, useEffect, useState } from 'react';
import Head from 'next/head';
import Navbar from '../components/Navbar/Navbar';
import Footer from '../components/Footer/Footer';
import { Inter } from 'next/font/google';
import './globals.css';
import { AppRouterCacheProvider } from '@mui/material-nextjs/v13-appRouter';
import { ThemeProvider, CssBaseline } from '@mui/material';
import { lightTheme, darkTheme } from '../app/theme';
import { AppBarProps } from '../types';
import useMediaQuery from '@mui/material/useMediaQuery';

const pages = [
  { label: 'Projects', link: '/projects' },
  { label: 'Docs', link: 'https://prove.email/docs.html' },
  { label: 'Blog', link: '/blog' },
  { label: 'Learn', link: '/learn' }
  // { label: 'Learn', link: 'https://prove.email/docs.html' }

];

const appBarProps: AppBarProps = {
  title: 'ZK Email',
  pages: pages
};

// Apply the Google font
const inter = Inter({ subsets: ['latin'] });

const RootLayout: React.FC<PropsWithChildren<{}>> = ({ children }) => {
  const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)');
  const [isDarkModeEnabled, setIsDarkModeEnabled] = useState(prefersDarkMode ?? false);

  const handleThemeChange = () => {
    setIsDarkModeEnabled(!isDarkModeEnabled);
  };

  useEffect(() => {
    setIsDarkModeEnabled(true)
  }, [prefersDarkMode])


  return (
    <html lang="en">
      <Head>
        <link rel="icon" href="/favicon.ico" />


        {/* styling math DELETE*/}
        <link
          rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"
          integrity="sha384-AJ3V7F54ts7VdU2Wm3ndoZrJ4EtyExNRdYQ7Z5IviTf1R7TuJvRHZTyrfl8RflyK"
        />
        {/* styling math */}



        <title>ZKEmail</title>
        <meta name="description" content="Generated by create next app" />
        <link
          href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600&display=swap"
          rel="stylesheet"
        />
      </Head>
      <body>
        <AppRouterCacheProvider>
          <ThemeProvider theme={isDarkModeEnabled ? darkTheme : lightTheme}>
            <CssBaseline />
            <div style={{ display: 'flex', flexDirection: 'column', minHeight: '100vh' }}>
              <Navbar {...appBarProps} isDarkModeEnabled={isDarkModeEnabled} setIsDarkModeEnabled={setIsDarkModeEnabled} />
              <main>{children}</main>
              <Footer />
            </div>
          </ThemeProvider>
        </AppRouterCacheProvider>
      </body>
    </html>
  );
};

export default RootLayout;
